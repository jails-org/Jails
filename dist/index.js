!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("jails",[],t):"object"==typeof exports?exports.jails=t():e.jails=t()}(self,(()=>(()=>{"use strict";var e={492:(e,t,n)=>{var r;n.r(t),n.d(t,{default:()=>f});var o="undefined"==typeof document?void 0:document,i=!!o&&"content"in o.createElement("template"),a=!!o&&o.createRange&&"createContextualFragment"in o.createRange();function l(e,t){var n,r,o=e.nodeName,i=t.nodeName;return o===i||(n=o.charCodeAt(0),r=i.charCodeAt(0),n<=90&&r>=97?o===i.toUpperCase():r<=90&&n>=97&&i===o.toUpperCase())}function s(e,t,n){e[n]!==t[n]&&(e[n]=t[n],e[n]?e.setAttribute(n,""):e.removeAttribute(n))}var u={OPTION:function(e,t){var n=e.parentNode;if(n){var r=n.nodeName.toUpperCase();"OPTGROUP"===r&&(r=(n=n.parentNode)&&n.nodeName.toUpperCase()),"SELECT"!==r||n.hasAttribute("multiple")||(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),n.selectedIndex=-1)}s(e,t,"selected")},INPUT:function(e,t){s(e,t,"checked"),s(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var n=t.value;e.value!==n&&(e.value=n);var r=e.firstChild;if(r){var o=r.nodeValue;if(o==n||!n&&o==e.placeholder)return;r.nodeValue=n}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var n,r,o=-1,i=0,a=e.firstChild;a;)if("OPTGROUP"===(r=a.nodeName&&a.nodeName.toUpperCase()))a=(n=a).firstChild;else{if("OPTION"===r){if(a.hasAttribute("selected")){o=i;break}i++}!(a=a.nextSibling)&&n&&(a=n.nextSibling,n=null)}e.selectedIndex=o}}};function d(){}function c(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}const f=function(e,t,n){if(n||(n={}),"string"==typeof t)if("#document"===e.nodeName||"HTML"===e.nodeName||"BODY"===e.nodeName){var s=t;(t=o.createElement("html")).innerHTML=s}else f=(f=t).trim(),t=i?function(e){var t=o.createElement("template");return t.innerHTML=e,t.content.childNodes[0]}(f):a?function(e){return r||(r=o.createRange()).selectNode(o.body),r.createContextualFragment(e).childNodes[0]}(f):function(e){var t=o.createElement("body");return t.innerHTML=e,t.childNodes[0]}(f);else 11===t.nodeType&&(t=t.firstElementChild);var f,m=n.getNodeKey||c,p=n.onBeforeNodeAdded||d,v=n.onNodeAdded||d,b=n.onBeforeElUpdated||d,h=n.onElUpdated||d,g=n.onBeforeNodeDiscarded||d,_=n.onNodeDiscarded||d,A=n.onBeforeElChildrenUpdated||d,y=n.skipFromChildren||d,N=n.addChild||function(e,t){return e.appendChild(t)},C=!0===n.childrenOnly,E=Object.create(null),x=[];function T(e){x.push(e)}function S(e,t){if(1===e.nodeType)for(var n=e.firstChild;n;){var r=void 0;t&&(r=m(n))?T(r):(_(n),n.firstChild&&S(n,t)),n=n.nextSibling}}function O(e,t,n){!1!==g(e)&&(t&&t.removeChild(e),_(e),S(e,n))}function $(e){v(e);for(var t=e.firstChild;t;){var n=t.nextSibling,r=m(t);if(r){var o=E[r];o&&l(t,o)?(t.parentNode.replaceChild(o,t),j(o,t)):$(t)}else $(t);t=n}}function j(e,t,n){var r=m(t);if(r&&delete E[r],!n){if(!1===b(e,t))return;if(function(e,t){var n,r,o,i,a=t.attributes;if(11!==t.nodeType&&11!==e.nodeType){for(var l=a.length-1;l>=0;l--)r=(n=a[l]).name,o=n.namespaceURI,i=n.value,o?(r=n.localName||r,e.getAttributeNS(o,r)!==i&&("xmlns"===n.prefix&&(r=n.name),e.setAttributeNS(o,r,i))):e.getAttribute(r)!==i&&e.setAttribute(r,i);for(var s=e.attributes,u=s.length-1;u>=0;u--)r=(n=s[u]).name,(o=n.namespaceURI)?(r=n.localName||r,t.hasAttributeNS(o,r)||e.removeAttributeNS(o,r)):t.hasAttribute(r)||e.removeAttribute(r)}}(e,t),h(e),!1===A(e,t))return}"TEXTAREA"!==e.nodeName?function(e,t){var n,r,i,a,s,d=y(e),c=t.firstChild,f=e.firstChild;e:for(;c;){for(a=c.nextSibling,n=m(c);!d&&f;){if(i=f.nextSibling,c.isSameNode&&c.isSameNode(f)){c=a,f=i;continue e}r=m(f);var v=f.nodeType,b=void 0;if(v===c.nodeType&&(1===v?(n?n!==r&&((s=E[n])?i===s?b=!1:(e.insertBefore(s,f),r?T(r):O(f,e,!0),f=s):b=!1):r&&(b=!1),(b=!1!==b&&l(f,c))&&j(f,c)):3!==v&&8!=v||(b=!0,f.nodeValue!==c.nodeValue&&(f.nodeValue=c.nodeValue))),b){c=a,f=i;continue e}r?T(r):O(f,e,!0),f=i}if(n&&(s=E[n])&&l(s,c))d||N(e,s),j(s,c);else{var h=p(c);!1!==h&&(h&&(c=h),c.actualize&&(c=c.actualize(e.ownerDocument||o)),N(e,c),$(c))}c=a,f=i}!function(e,t,n){for(;t;){var r=t.nextSibling;(n=m(t))?T(n):O(t,e,!0),t=r}}(e,f,r);var g=u[e.nodeName];g&&g(e,t)}(e,t):u.TEXTAREA(e,t)}!function e(t){if(1===t.nodeType||11===t.nodeType)for(var n=t.firstChild;n;){var r=m(n);r&&(E[r]=n),e(n),n=n.nextSibling}}(e);var w,M,P=e,L=P.nodeType,U=t.nodeType;if(!C)if(1===L)1===U?l(e,t)||(_(e),P=function(e,t){for(var n=e.firstChild;n;){var r=n.nextSibling;t.appendChild(n),n=r}return t}(e,(w=t.nodeName,(M=t.namespaceURI)&&"http://www.w3.org/1999/xhtml"!==M?o.createElementNS(M,w):o.createElement(w)))):P=t;else if(3===L||8===L){if(U===L)return P.nodeValue!==t.nodeValue&&(P.nodeValue=t.nodeValue),P;P=t}if(P===t)_(e);else{if(t.isSameNode&&t.isSameNode(P))return;if(j(P,t,C),x)for(var k=0,F=x.length;k<F;k++){var R=E[x[k]];R&&O(R,R.parentNode,!1)}}return!C&&P!==e&&e.parentNode&&(P.actualize&&(P=P.actualize(e.ownerDocument||o)),e.parentNode.replaceChild(P,e)),P}},565:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(492)),i=n(502),a=n(585),l=n(139),s=n(119);t.default=function(e,{module:t,dependencies:n,templates:r,components:c}){const f=u(t);(0,a.buildtemplates)(e,c,r);const m=e.getAttribute("tplid"),p=m?r[m]:null,v={data:t.model?(0,i.dup)(t.model):{}};v.data=Object.assign(v.data,e.initialState?JSON.parse(e.initialState):null);const b={template:p,elm:e,dependencies:n,publish:s.publish,subscribe:s.subscribe,main(e){f.main=e},unmount(e){f.unmount=e},onupdate(e){f.onupdate=e},on(t,n,r){(0,l.on)(e,t,n,r)},off(t,n){(0,l.off)(e,t,n)},trigger(t,n,r){n.constructor===String?Array.from(e.querySelectorAll(n)).forEach((e=>(0,l.trigger)(e,t,{args:r}))):(0,l.trigger)(e,t,{args:n})},emit:(...t)=>{(0,l.trigger)(e,t.shift(),{args:t})},state:{set(e){if(e.constructor===Function){const t=(0,i.dup)(v.data);e(t),b.render(t)}else b.render(e);return new Promise((e=>(0,i.rAF)((t=>(0,i.rAF)((()=>e(v.data)))))))},get:()=>(0,i.dup)(v.data),getRaw:()=>v.data},render(t=v.data){if(!document.body.contains(e))return;v.data=Object.assign(v.data,t);const n=(0,i.dup)(v.data),r=b.template(f.view(n));(0,o.default)(e,r,d(e,f)),(0,i.rAF)((t=>{Array.from(e.querySelectorAll("[tplid]")).forEach((e=>{e.options.onupdate(n),e.base.render(Object.assign(n,e.base.state.getRaw()))}))}))}};return{base:b,options:f}};const u=e=>({main:e=>e,unmount:e=>e,onupdate:e=>e,view:e.view?e.view:e=>e}),d=(e,t)=>({onNodeAdded:f(e,t),onElUpdated:f(e,t),onBeforeElChildrenUpdated:c,onBeforeElUpdated:c,getNodeKey:e=>!(1!==e.nodeType||!e.getAttribute("tplid"))&&("key"in e.attributes?e.attributes.key.value:e.getAttribute("tplid"))}),c=e=>{if("html-static"in e.attributes)return!1},f=(e,t)=>n=>{if(1===n.nodeType&&n.getAttribute&&n.getAttribute("html-scope")){const r=n.getAttribute("html-scope"),o=new Function(`return ${r}`)();Array.from(n.querySelectorAll("[tplid]")).map((n=>{const r=Object.assign({},e.base.state.get(),o);t.onupdate(r),n.base.render(r)}))}return n}},747:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(565)),i=n(502);t.default=function(e,t,n,r){return class extends HTMLElement{constructor(){super();const{base:i,options:a}=(0,o.default)(this,{module:e,dependencies:t,templates:n,components:r});this.base=i,this.options=a,this.returns=e.default(i)}connectedCallback(){var e;this.base.render(),this.returns&&this.returns.constructor===Promise?this.returns.then((e=>{var t;this.base&&(null===(t=this.options.main())||void 0===t||t.forEach((e=>e(this.base))))})):null===(e=this.options.main())||void 0===e||e.forEach((e=>e(this.base)))}disconnectedCallback(){this.options.unmount(this.base),document.body.contains(this)||(this.__events=null,this.base.elm=null,this.base=null,(0,i.purge)(this))}attributeChangedCallback(){}}}},341:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(585),i=r(n(747)),a={},l={};t.default={templateConfig:o.templateConfig,register(e,t,n){l[e]={name:e,module:t,dependencies:n}},start(){const e=document.body;(0,o.buildtemplates)(e,l,a),s()}};const s=()=>{Object.values(l).forEach((e=>{const{name:t,module:n,dependencies:r}=e,o=(0,i.default)(n,r,a,l);customElements.define(t,o)}))}},585:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buildtemplates=t.templateConfig=void 0;const r=n(502),o=document.createElement("template"),i=document.createElement("textarea");function a(e){const n=new RegExp(`${t.templateConfig.tags[0]}(.*?)${t.templateConfig.tags[1]}`,"g");c(e),o.innerHTML=e.outerHTML.replace(/<\/?template[^>]*>/g,"").replace(n,"${$1}"),Array.from(o.content.querySelectorAll("[html-for],[html-if],[html-inner],[html-class]")).forEach((e=>{e.getAttribute("html-inner")&&u(e),e.getAttribute("html-for")&&l(e),e.getAttribute("html-if")&&s(e),e.getAttribute("html-class")&&d(e)}));const r=o.innerHTML.replace(/html-(allowfullscreen|async|autofocus|autoplay|checked|controls|default|defer|disabled|formnovalidate|inert|ismap|itemscope|loop|multiple|muted|nomodule|novalidate|open|playsinline|readonly|required|reversed|selected)=\"(.*?)\"/g,'${$2?"$1":""}').replace(/html-(.*?)=\"(.*?)\"/g,((e,t,n)=>"scope"==t||"model"==t?e:n?"${ ("+(n=n.replace(/^{|}$/g,""))+") ? `"+t+'="${'+n+'}"`:""}':e));return new Function("$_data_$","with($_data_$){ return `"+p(r)+"`}")}t.templateConfig={tags:["{","}"]},t.default=a,t.buildtemplates=(e,n,r)=>Array.from(e.querySelectorAll("*")).filter((e=>e.tagName.toLowerCase()in n)).reverse().map((e=>(Array.from(e.querySelectorAll("template")).map((e=>(0,t.buildtemplates)(e.content,n,r))),m(e,r),e)));const l=e=>{const t=e.getAttribute("html-for").split(/\sin\s/),n=t[0].trim(),r="${ Object.entries("+t[1].trim()+").map(function( args ){ var "+n+' = args[1]; var $index = args[0]; var $key = args[0]; var scope = {}; scope["'+n+'"]=args[1]; scope.$index = $index; scope.$key= $key; return `';e.removeAttribute("html-for"),e.setAttribute("html-scope",'${JSON.stringify(scope).replace(/"/g, "\'")}'),f(r,e,'`}).join("")}')},s=e=>{const t=e.getAttribute("html-if");e.removeAttribute("html-if");const n="${"+t+"?`"+e.outerHTML+'`:"" }';e.outerHTML=n},u=e=>{const t=e.getAttribute("html-inner");e.removeAttribute("html-inner"),e.innerHTML="${"+t+"}"},d=e=>{const t=e.getAttribute("html-class").replace(/^{|}$/g,"");e.removeAttribute("html-class"),e.className+=" ${"+t+"}"},c=e=>{const t=e.getAttribute("html-model");e.initialState=t?JSON.stringify(new Function(`return ${t}`)()):null,e.removeAttribute("html-model")},f=(e,t,n)=>{var r,o;null===(r=t.parentNode)||void 0===r||r.insertBefore(document.createTextNode(e),t),null===(o=t.parentNode)||void 0===o||o.insertBefore(document.createTextNode(n),t.nextSibling)},m=(e,t)=>{if(!e.getAttribute("tplid")){const n=(0,r.uuid)();e.setAttribute("tplid",n),t[n]=a(e)}},p=e=>(i.innerHTML=e,i.value)},139:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.trigger=t.off=t.on=void 0;const n="CustomEvent"in window&&"function"==typeof window.CustomEvent?(e,t)=>new CustomEvent(e,t):(e,t)=>{const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!0,!0,t),n},r=(e,t)=>function(n){const r=this,o=n.detail||{};e.__events[t].forEach((e=>{e.handler.apply(r,[n].concat(o.args))}))},o=(e,t)=>{e.__events[t]&&e.__events[t].listener&&(e.removeEventListener(t,e.__events[t].listener,"focus"==t||"blur"==t||"mouseenter"==t||"mouseleave"==t),delete e.__events[t])},i=(e,t,n)=>function(r){const o=this,i=r.detail||{};let a=r.target;for(;a&&(a.matches(t)&&(r.delegateTarget=a,n.apply(o,[r].concat(i.args))),a!==e);)a=a.parentNode};t.on=(e,t,n,o)=>{if(e.__events=e.__events||{},e.__events[t]=e.__events[t]||[],!e.__events[t].length){const n=r(e,t);e.addEventListener(t,n,"focus"==t||"blur"==t||"mouseenter"==t||"mouseleave"==t),e.__events[t].listener=n}n.call?e.__events[t].push({handler:n,callback:n}):e.__events[t].push({handler:i(e,n,o),callback:o})},t.off=(e,t,n)=>{if(n&&e.__events[t]&&e.__events[t].length){var r=e.__events[t];e.__events[t]=e.__events[t].filter((function(e){return e.callback!=n})),e.__events[t].listener=r.listener,e.__events[t].length||o(e,t)}else o(e,t)},t.trigger=(e,t,r)=>{e.dispatchEvent(n(t,{bubbles:!0,detail:r}))}},502:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.purge=t.dup=t.uuid=t.rAF=void 0,t.rAF=e=>requestAnimationFrame?requestAnimationFrame(e):setTimeout(e,1e3/60),t.uuid=()=>"xxxxxxxx".replace(/[xy]/g,(e=>{const t=8*Math.random()|0;return("x"==e?t:3&t|8).toString(8)})),t.dup=e=>JSON.parse(JSON.stringify(e)),t.purge=e=>{var n,r,o,i=e.attributes;if(i)for(n=i.length-1;n>=0;n-=1)"function"==typeof e[o=i[n].name]&&(e[o]=null);if(i=e.childNodes)for(r=i.length,n=0;n<r;n+=1)(0,t.purge)(e.childNodes[n])}},119:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscribe=t.publish=void 0;const n={},r={};t.publish=(e,t)=>{r[e]=Object.assign({},r[e],t),n[e]&&n[e].forEach((e=>e(t)))},t.subscribe=(e,t)=>(n[e]=n[e]||[],n[e].push(t),e in r&&t(r[e]),()=>{n[e]=n[e].filter((e=>e!=t))})}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}return n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(341)})()));
//# sourceMappingURL=index.js.map