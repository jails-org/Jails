!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("jails",[],t):"object"==typeof exports?exports.jails=t():e.jails=t()}(self,(()=>(()=>{var e={492:(e,t,n)=>{"use strict";var r;n.r(t),n.d(t,{default:()=>f});var i="undefined"==typeof document?void 0:document,a=!!i&&"content"in i.createElement("template"),o=!!i&&i.createRange&&"createContextualFragment"in i.createRange();function s(e,t){var n,r,i=e.nodeName,a=t.nodeName;return i===a||(n=i.charCodeAt(0),r=a.charCodeAt(0),n<=90&&r>=97?i===a.toUpperCase():r<=90&&n>=97&&a===i.toUpperCase())}function l(e,t,n){e[n]!==t[n]&&(e[n]=t[n],e[n]?e.setAttribute(n,""):e.removeAttribute(n))}var u={OPTION:function(e,t){var n=e.parentNode;if(n){var r=n.nodeName.toUpperCase();"OPTGROUP"===r&&(r=(n=n.parentNode)&&n.nodeName.toUpperCase()),"SELECT"!==r||n.hasAttribute("multiple")||(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),n.selectedIndex=-1)}l(e,t,"selected")},INPUT:function(e,t){l(e,t,"checked"),l(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var n=t.value;e.value!==n&&(e.value=n);var r=e.firstChild;if(r){var i=r.nodeValue;if(i==n||!n&&i==e.placeholder)return;r.nodeValue=n}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var n,r,i=-1,a=0,o=e.firstChild;o;)if("OPTGROUP"===(r=o.nodeName&&o.nodeName.toUpperCase()))o=(n=o).firstChild;else{if("OPTION"===r){if(o.hasAttribute("selected")){i=a;break}a++}!(o=o.nextSibling)&&n&&(o=n.nextSibling,n=null)}e.selectedIndex=i}}};function c(){}function d(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}const f=function(e,t,n){if(n||(n={}),"string"==typeof t)if("#document"===e.nodeName||"HTML"===e.nodeName||"BODY"===e.nodeName){var l=t;(t=i.createElement("html")).innerHTML=l}else f=(f=t).trim(),t=a?function(e){var t=i.createElement("template");return t.innerHTML=e,t.content.childNodes[0]}(f):o?function(e){return r||(r=i.createRange()).selectNode(i.body),r.createContextualFragment(e).childNodes[0]}(f):function(e){var t=i.createElement("body");return t.innerHTML=e,t.childNodes[0]}(f);else 11===t.nodeType&&(t=t.firstElementChild);var f,p=n.getNodeKey||d,m=n.onBeforeNodeAdded||c,h=n.onNodeAdded||c,v=n.onBeforeElUpdated||c,g=n.onElUpdated||c,b=n.onBeforeNodeDiscarded||c,y=n.onNodeDiscarded||c,x=n.onBeforeElChildrenUpdated||c,A=n.skipFromChildren||c,_=n.addChild||function(e,t){return e.appendChild(t)},N=!0===n.childrenOnly,$=Object.create(null),S=[];function T(e){S.push(e)}function w(e,t){if(1===e.nodeType)for(var n=e.firstChild;n;){var r=void 0;t&&(r=p(n))?T(r):(y(n),n.firstChild&&w(n,t)),n=n.nextSibling}}function C(e,t,n){!1!==b(e)&&(t&&t.removeChild(e),y(e),w(e,n))}function E(e){h(e);for(var t=e.firstChild;t;){var n=t.nextSibling,r=p(t);if(r){var i=$[r];i&&s(t,i)?(t.parentNode.replaceChild(i,t),O(i,t)):E(t)}else E(t);t=n}}function O(e,t,n){var r=p(t);if(r&&delete $[r],!n){if(!1===v(e,t))return;if(function(e,t){var n,r,i,a,o=t.attributes;if(11!==t.nodeType&&11!==e.nodeType){for(var s=o.length-1;s>=0;s--)r=(n=o[s]).name,i=n.namespaceURI,a=n.value,i?(r=n.localName||r,e.getAttributeNS(i,r)!==a&&("xmlns"===n.prefix&&(r=n.name),e.setAttributeNS(i,r,a))):e.getAttribute(r)!==a&&e.setAttribute(r,a);for(var l=e.attributes,u=l.length-1;u>=0;u--)r=(n=l[u]).name,(i=n.namespaceURI)?(r=n.localName||r,t.hasAttributeNS(i,r)||e.removeAttributeNS(i,r)):t.hasAttribute(r)||e.removeAttribute(r)}}(e,t),g(e),!1===x(e,t))return}"TEXTAREA"!==e.nodeName?function(e,t){var n,r,a,o,l,c=A(e),d=t.firstChild,f=e.firstChild;e:for(;d;){for(o=d.nextSibling,n=p(d);!c&&f;){if(a=f.nextSibling,d.isSameNode&&d.isSameNode(f)){d=o,f=a;continue e}r=p(f);var h=f.nodeType,v=void 0;if(h===d.nodeType&&(1===h?(n?n!==r&&((l=$[n])?a===l?v=!1:(e.insertBefore(l,f),r?T(r):C(f,e,!0),f=l):v=!1):r&&(v=!1),(v=!1!==v&&s(f,d))&&O(f,d)):3!==h&&8!=h||(v=!0,f.nodeValue!==d.nodeValue&&(f.nodeValue=d.nodeValue))),v){d=o,f=a;continue e}r?T(r):C(f,e,!0),f=a}if(n&&(l=$[n])&&s(l,d))c||_(e,l),O(l,d);else{var g=m(d);!1!==g&&(g&&(d=g),d.actualize&&(d=d.actualize(e.ownerDocument||i)),_(e,d),E(d))}d=o,f=a}!function(e,t,n){for(;t;){var r=t.nextSibling;(n=p(t))?T(n):C(t,e,!0),t=r}}(e,f,r);var b=u[e.nodeName];b&&b(e,t)}(e,t):u.TEXTAREA(e,t)}!function e(t){if(1===t.nodeType||11===t.nodeType)for(var n=t.firstChild;n;){var r=p(n);r&&($[r]=n),e(n),n=n.nextSibling}}(e);var j,F,P=e,R=P.nodeType,I=t.nodeType;if(!N)if(1===R)1===I?s(e,t)||(y(e),P=function(e,t){for(var n=e.firstChild;n;){var r=n.nextSibling;t.appendChild(n),n=r}return t}(e,(j=t.nodeName,(F=t.namespaceURI)&&"http://www.w3.org/1999/xhtml"!==F?i.createElementNS(F,j):i.createElement(j)))):P=t;else if(3===R||8===R){if(I===R)return P.nodeValue!==t.nodeValue&&(P.nodeValue=t.nodeValue),P;P=t}if(P===t)y(e);else{if(t.isSameNode&&t.isSameNode(P))return;if(O(P,t,N),S)for(var M=0,k=S.length;M<k;M++){var H=$[S[M]];H&&C(H,H.parentNode,!1)}}return!N&&P!==e&&e.parentNode&&(P.actualize&&(P=P.actualize(e.ownerDocument||i)),e.parentNode.replaceChild(P,e)),P}},565:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(492)),a=n(502),o=n(139),s=n(119);t.default=function(e,{module:t,dependencies:n,templates:r,components:c}){const d=l(t);(0,a.buildtemplates)(e,c,r);const f=e.getAttribute("tplid"),p=f?r[f]:null,m={data:t.model?(0,a.dup)(t.model):{}};m.data=Object.assign(m.data,e.initialState?JSON.parse(e.initialState):null);const h={template:p,elm:e,dependencies:n,publish:s.publish,subscribe:s.subscribe,main(e){d.main=e},unmount(e){d.unmount=e},onupdate(e){d.onupdate=e},on(t,n,r){(0,o.on)(e,t,n,r)},off(t,n){(0,o.off)(e,t,n)},trigger(t,n,r){n.constructor===String?Array.from(e.querySelectorAll(n)).forEach((e=>(0,o.trigger)(e,t,{args:r}))):(0,o.trigger)(e,t,{args:n})},emit:(...t)=>{(0,o.trigger)(e,t.shift(),{args:t})},state:{set(e){if(e.constructor===Function){const t=(0,a.dup)(m.data);e(t),h.render(t)}else h.render(e);return new Promise((e=>(0,a.rAF)((t=>(0,a.rAF)((()=>e(m.data)))))))},get:()=>(0,a.dup)(m.data),getRaw:()=>m.data},render(t=m.data){if(!document.body.contains(e))return;m.data=Object.assign(m.data,t);const n=(0,a.dup)(m.data),r=h.template(d.view(n));(0,i.default)(e,r,u(e,d)),(0,a.rAF)((t=>{Array.from(e.querySelectorAll("[tplid]")).forEach((e=>{const t=Object.assign(n,e.base.state.getRaw());e.options.onupdate(t),e.base.render(t)}))}))}};return{base:h,options:d}};const l=e=>({main:e=>e,unmount:e=>e,onupdate:e=>e,view:e.view?e.view:e=>e}),u=(e,t)=>({onNodeAdded:d(e,t),onElUpdated:d(e,t),onBeforeElChildrenUpdated:c,onBeforeElUpdated:c,getNodeKey(e){if(1===e.nodeType){if(e.id)return e.id;if(e.getAttribute("tplid"))return e.getAttribute("tplid");if(e.getAttribute("html-key"))return e.getAttribute("html-key")}return!1}}),c=e=>{if("html-static"in e.attributes)return!1},d=(e,t)=>n=>{if(1===n.nodeType&&n.getAttribute&&n.getAttribute("scope")){const r=n.getAttribute("scope"),i=new Function(`return ${r}`)();(0,a.rAF)((r=>{Array.from(n.querySelectorAll("[tplid]")).map((n=>{const r=Object.assign({},e.base.state.getRaw(),i);t.onupdate(r),n.base.render(r)}))}))}return n}},747:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(565)),a=n(502);t.default=function(e,t,n,r){return class extends HTMLElement{constructor(){super();const{base:a,options:o}=(0,i.default)(this,{module:e,dependencies:t,templates:n,components:r});this.base=a,this.options=o,this.returns=e.default(a)}connectedCallback(){var e;this.base.render(),this.returns&&this.returns.constructor===Promise?this.returns.then((e=>{var t;this.base&&(null===(t=this.options.main())||void 0===t||t.forEach((e=>e(this.base))))})):null===(e=this.options.main())||void 0===e||e.forEach((e=>e(this.base)))}disconnectedCallback(){this.options.unmount(this.base),(0,a.rAF)((()=>{document.body.contains(this)||(this.__events=null,this.base.elm=null,this.base=null,(0,a.purge)(this))}))}attributeChangedCallback(){}}}},341:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(502),a=n(585),o=r(n(747)),s={},l={};t.default={templateConfig:a.templateConfig,register(e,t,n){l[e]={name:e,module:t,dependencies:n}},start(){const e=document.body;(0,i.buildtemplates)(e,l,s),u()}};const u=()=>{Object.values(l).forEach((e=>{const{name:t,module:n,dependencies:r}=e,i=(0,o.default)(n,r,s,l);customElements.define(t,i)}))}},585:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.templateConfig=void 0;const r=n(641),i=n(502);r.defaultConfig.tags=["{","}"],r.defaultConfig.useWith=!0,t.default=function(e){const t=document.createElement("template"),n=r.defaultConfig.tags[0],o=r.defaultConfig.tags[1];e.initialState=s(e),t.innerHTML=e.outerHTML.replace(/<\/?template[^>]*>/g,""),a(t.content);const l=(0,i.decodeHtmlEntities)(t.innerHTML.replace(/html-(allowfullscreen|async|autofocus|autoplay|checked|controls|default|defer|disabled|formnovalidate|inert|ismap|itemscope|loop|multiple|muted|nomodule|novalidate|open|playsinline|readonly|required|reversed|selected)=\"(.*?)\"/g,`${n}@if ($2) ${o}$1${n}/if${o}`).replace(/html-(.*?)=\"(.*?)\"/g,((e,t,r)=>"key"===t?e:r?(r=r.replace(/^{|}$/g,""),`${n}@if (${r}) ${o} ${t}="${n}${r}${o}" ${n}/if${o}`):e))),u=(0,r.compile)(l,r.defaultConfig);return e=>u(e,r.defaultConfig)};const a=e=>{const t=Array.from(e.querySelectorAll("[html-for],[html-if],[html-foreach],[html-inner],[html-model],[html-class]")).reverse();if(t.length){const e=r.defaultConfig.tags[0],n=r.defaultConfig.tags[1];t.forEach((t=>{if(t.getAttribute("html-foreach")){const r=(t.getAttribute("html-foreach")||"").match(/(.*)\sin\s(.*)/)||"",i=r[1],a=r[2];t.removeAttribute("html-foreach"),t.setAttribute("scope",`${e}${i} | JSON($key, '${i}')${n}`);const s=document.createTextNode(`${e}@foreach(${a}) => $key, ${i}${n}`),l=document.createTextNode(`${e}/foreach${n}`);o(s,t,l)}if(t.getAttribute("html-for")){const r=(t.getAttribute("html-for")||"").match(/(.*)\sin\s(.*)/)||"",i=r[1],a=r[2];t.removeAttribute("html-for"),t.setAttribute("scope",`${e}${i} | JSON($index, '${i}')${n}`);const s=document.createTextNode(`${e}@each(${a}) => ${i}, $index${n}`),l=document.createTextNode(`${e}/each${n}`);o(s,t,l)}if(t.getAttribute("html-if")){const r=t.getAttribute("html-if");t.removeAttribute("html-if");const i=document.createTextNode(`${e}@if (${r}) ${n}`),a=document.createTextNode(`${e}/if${n}`);o(i,t,a)}if(t.getAttribute("html-inner")){const r=t.getAttribute("html-inner");t.removeAttribute("html-inner"),t.innerHTML=`${e}${r} | safe${n}`}if(t.getAttribute("html-class")){const r=t.getAttribute("html-class").replace(/^{|}$/g,"");t.removeAttribute("html-class"),t.className+=` ${e}${r}${n}`}}))}return e};t.templateConfig=e=>{Object.assign(r.defaultConfig,e)},r.filters.define("JSON",((e,t,n)=>{const r=t.constructor==String?"$key":"$index",i={$index:t};return i[n]=e,i[r]=t,JSON.stringify(i)}));const o=(e,t,n)=>{var r,i;null===(r=t.parentNode)||void 0===r||r.insertBefore(e,t),null===(i=t.parentNode)||void 0===i||i.insertBefore(n,t.nextSibling)},s=e=>{const t=e.getAttribute("html-model");return t?(e.removeAttribute("html-model"),JSON.stringify(new Function(`return ${t}`)())):null}},139:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.trigger=t.off=t.on=void 0;const n="CustomEvent"in window&&"function"==typeof window.CustomEvent?(e,t)=>new CustomEvent(e,t):(e,t)=>{const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!0,!0,t),n},r=(e,t)=>function(n){const r=this,i=n.detail||{};e.__events[t].forEach((e=>{e.handler.apply(r,[n].concat(i.args))}))},i=(e,t)=>{e.__events[t]&&e.__events[t].listener&&(e.removeEventListener(t,e.__events[t].listener,"focus"==t||"blur"==t||"mouseenter"==t||"mouseleave"==t),delete e.__events[t])},a=(e,t,n)=>function(r){const i=this,a=r.detail||{};let o=r.target;for(;o&&(o.matches(t)&&(r.delegateTarget=o,n.apply(i,[r].concat(a.args))),o!==e);)o=o.parentNode};t.on=(e,t,n,i)=>{if(e.__events=e.__events||{},e.__events[t]=e.__events[t]||[],!e.__events[t].length){const n=r(e,t);e.addEventListener(t,n,"focus"==t||"blur"==t||"mouseenter"==t||"mouseleave"==t),e.__events[t].listener=n}n.call?e.__events[t].push({handler:n,callback:n}):e.__events[t].push({handler:a(e,n,i),callback:i})},t.off=(e,t,n)=>{if(n&&e.__events[t]&&e.__events[t].length){var r=e.__events[t];e.__events[t]=e.__events[t].filter((function(e){return e.callback!=n})),e.__events[t].listener=r.listener,e.__events[t].length||i(e,t)}else i(e,t)},t.trigger=(e,t,r)=>{e.dispatchEvent(n(t,{bubbles:!0,detail:r}))}},502:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.purge=t.decodeHtmlEntities=t.buildtemplates=t.createTemplateId=t.dup=t.stripTemplateTag=t.uuid=t.rAF=void 0;const i=r(n(585)),a=document.createElement("textarea");t.rAF=e=>requestAnimationFrame?requestAnimationFrame(e):setTimeout(e,1e3/60),t.uuid=()=>"xxxxxxxx".replace(/[xy]/g,(e=>{const t=8*Math.random()|0;return("x"==e?t:3&t|8).toString(8)})),t.stripTemplateTag=e=>{Array.from(e.querySelectorAll("template")).forEach((e=>{var n;null===(n=e.parentNode)||void 0===n||n.replaceChild(e.content,e),(0,t.stripTemplateTag)(e.content)}))},t.dup=e=>JSON.parse(JSON.stringify(e)),t.createTemplateId=(e,n)=>{if(!e.getAttribute("tplid")){const r=(0,t.uuid)();e.setAttribute("tplid",r),n[r]=(0,i.default)(e)}},t.buildtemplates=(e,n,r)=>Array.from(e.querySelectorAll("*")).filter((e=>e.tagName.toLowerCase()in n)).reverse().map((e=>(Array.from(e.querySelectorAll("template")).map((e=>(0,t.buildtemplates)(e.content,n,r))),(0,t.createTemplateId)(e,r),e))),t.decodeHtmlEntities=e=>(a.innerHTML=e,a.value),t.purge=e=>{var n,r,i,a=e.attributes;if(a)for(n=a.length-1;n>=0;n-=1)"function"==typeof e[i=a[n].name]&&(e[i]=null);if(a=e.childNodes)for(r=a.length,n=0;n<r;n+=1)(0,t.purge)(e.childNodes[n])}},119:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.subscribe=t.publish=void 0;const n={},r={};t.publish=(e,t)=>{r[e]=Object.assign({},r[e],t),n[e]&&n[e].forEach((e=>e(t)))},t.subscribe=(e,t)=>(n[e]=n[e]||[],n[e].push(t),e in r&&t(r[e]),()=>{n[e]=n[e].filter((e=>e!=t))})},641:function(e,t){!function(e){"use strict";function t(e){var n,r,i=new Error(e);return n=i,r=t.prototype,Object.setPrototypeOf?Object.setPrototypeOf(n,r):n.__proto__=r,i}function n(e,n,r){var i=n.slice(0,r).split(/\n/),a=i.length,o=i[a-1].length+1;throw t(e+=" at line "+a+" col "+o+":\n\n  "+n.split(/\n/)[a-1]+"\n  "+Array(o).join(" ")+"^")}t.prototype=Object.create(Error.prototype,{name:{value:"Squirrelly Error",enumerable:!1}});var r=new Function("return this")().Promise,i=!1;try{i=new Function("return (async function(){}).constructor")()}catch(e){if(!(e instanceof SyntaxError))throw e}var a=function(e,t){return"(function(){\n    try{\n      return "+e+" == undefined || "+e+" == null? '': "+e+"\n    }catch(err) {\n      return ''\n    }\n  })()"};function o(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function s(e,t,n){for(var r in t)o(t,r)&&(null==t[r]||"object"!=typeof t[r]||"storage"!==r&&"prefixes"!==r||n?e[r]=t[r]:e[r]=s({},t[r]));return e}var l=/^async +/,u=/`(?:\\[\s\S]|\${(?:[^{}]|{(?:[^{}]|{[^}]*})*})*}|(?!\${)[^\\`])*`/g,c=/'(?:\\[\s\w"'\\`]|[^\n\r'\\])*?'/g,d=/"(?:\\[\s\w"'\\`]|[^\n\r"\\])*?"/g,f=/[.*+\-?^${}()|[\]\\]/g;function p(e){return f.test(e)?e.replace(f,"\\$&"):e}function m(e,r){r.rmWhitespace&&(e=e.replace(/[\r\n]+/g,"\n").replace(/^\s+|\s+$/gm,"")),u.lastIndex=0,c.lastIndex=0,d.lastIndex=0;var i=r.prefixes,a=[i.h,i.b,i.i,i.r,i.c,i.e].reduce((function(e,t){return e&&t?e+"|"+p(t):t?p(t):e}),""),o=new RegExp("([|()]|=>)|('|\"|`|\\/\\*)|\\s*((\\/)?(-|_)?"+p(r.tags[1])+")","g"),s=new RegExp("([^]*?)"+p(r.tags[0])+"(-|_)?\\s*("+a+")?\\s*","g"),f=0,m=!1;function h(t,i){var a,p={f:[]},h=0,v="c";function g(t){var i=e.slice(f,t),a=i.trim();if("f"===v)"safe"===a?p.raw=!0:r.async&&l.test(a)?(a=a.replace(l,""),p.f.push([a,"",!0])):p.f.push([a,""]);else if("fp"===v)p.f[p.f.length-1][1]+=a;else if("err"===v){if(a){var o=i.search(/\S/);n("invalid syntax",e,f+o)}}else p[v]=a;f=t+1}for("h"===i||"b"===i||"c"===i?v="n":"r"===i&&(p.raw=!0,i="i"),o.lastIndex=f;null!==(a=o.exec(e));){var b=a[1],y=a[2],x=a[3],A=a[4],_=a[5],N=a.index;if(b)"("===b?(0===h&&("n"===v?(g(N),v="p"):"f"===v&&(g(N),v="fp")),h++):")"===b?0==--h&&"c"!==v&&(g(N),v="err"):0===h&&"|"===b?(g(N),v="f"):"=>"===b&&(g(N),f+=1,v="res");else if(y)if("/*"===y){var $=e.indexOf("*/",o.lastIndex);-1===$&&n("unclosed comment",e,a.index),o.lastIndex=$+2}else"'"===y?(c.lastIndex=a.index,c.exec(e)?o.lastIndex=c.lastIndex:n("unclosed string",e,a.index)):'"'===y?(d.lastIndex=a.index,d.exec(e)?o.lastIndex=d.lastIndex:n("unclosed string",e,a.index)):"`"===y&&(u.lastIndex=a.index,u.exec(e)?o.lastIndex=u.lastIndex:n("unclosed string",e,a.index));else if(x)return g(N),f=N+a[0].length,s.lastIndex=f,m=_,A&&"h"===i&&(i="s"),p.t=i,p}return n("unclosed tag",e,t),p}var v=function a(o,u){o.b=[],o.d=[];var c,d=!1,p=[];function v(e,t){e&&(e=function(e,t,n,r){var i,a;return"string"==typeof t.autoTrim?i=a=t.autoTrim:Array.isArray(t.autoTrim)&&(i=t.autoTrim[1],a=t.autoTrim[0]),(n||!1===n)&&(i=n),(r||!1===r)&&(a=r),"slurp"===i&&"slurp"===a?e.trim():("_"===i||"slurp"===i?e=String.prototype.trimLeft?e.trimLeft():e.replace(/^[\s\uFEFF\xA0]+/,""):"-"!==i&&"nl"!==i||(e=e.replace(/^(?:\n|\r|\r\n)/,"")),"_"===a||"slurp"===a?e=String.prototype.trimRight?e.trimRight():e.replace(/[\s\uFEFF\xA0]+$/,""):"-"!==a&&"nl"!==a||(e=e.replace(/(?:\n|\r|\r\n)$/,"")),e)}(e,r,m,t))&&(e=e.replace(/\\|'/g,"\\$&").replace(/\r\n|\n|\r/g,"\\n"),p.push(e))}for(;null!==(c=s.exec(e));){var g,b=c[1],y=c[2],x=c[3]||"";for(var A in i)if(i[A]===x){g=A;break}v(b,y),f=c.index+c[0].length,g||n("unrecognized tag type: "+x,e,f);var _=h(c.index,g),N=_.t;if("h"===N){var $=_.n||"";r.async&&l.test($)&&(_.a=!0,_.n=$.replace(l,"")),_=a(_),p.push(_)}else if("c"===N){if(o.n===_.n)return d?(d.d=p,o.b.push(d)):o.d=p,o;n("Helper start and end don't match",e,c.index+c[0].length)}else if("b"===N){d?(d.d=p,o.b.push(d)):o.d=p;var S=_.n||"";r.async&&l.test(S)&&(_.a=!0,_.n=S.replace(l,"")),d=_,p=[]}else if("s"===N){var T=_.n||"";r.async&&l.test(T)&&(_.a=!0,_.n=T.replace(l,"")),p.push(_)}else p.push(_)}if(!u)throw t('unclosed helper "'+o.n+'"');return v(e.slice(f,e.length),!1),o.d=p,o}({f:[]},!0);if(r.plugins)for(var g=0;g<r.plugins.length;g++){var b=r.plugins[g];b.processAST&&(v.d=b.processAST(v.d,r))}return v.d}function h(e,t){var n=m(e,t),r="var tR='';"+(t.useWith?"with("+t.varName+"||{}){":"")+x(n,t)+"if(cb){cb(null,tR)} return tR"+(t.useWith?"}":"");if(t.plugins)for(var i=0;i<t.plugins.length;i++){var a=t.plugins[i];a.processFnString&&(r=a.processFnString(r,t))}return r}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n][0],i=t[n][1];e=(t[n][2]?"await ":"")+"c.l('F','"+r+"')("+e,i&&(e+=","+i),e+=")"}return e}function g(e,t,n,r,i,a){var o="{exec:"+(i?"async ":"")+y(n,t,e)+",params:["+r+"]";return a&&(o+=",name:'"+a+"'"),i&&(o+=",async:true"),o+"}"}function b(e,t){for(var n="[",r=0;r<e.length;r++){var i=e[r];n+=g(t,i.res||"",i.d,i.p||"",i.a,i.n),r<e.length&&(n+=",")}return n+"]"}function y(e,t,n){return"function("+t+"){var tR='';"+x(e,n)+"return tR}"}function x(e,t){for(var n=0,r=e.length,i="";n<r;n++){var o=e[n];if("string"==typeof o)i+="tR+='"+o+"';";else{o.c=a(o.c||""),o.p=a(o.p||"");var s=o.t,l=o.c,u=o.f,c=o.n||"",d=o.p,f=o.res||"",p=o.b,m=!!o.a;if("i"===s){t.defaultFilter&&(l="c.l('F','"+t.defaultFilter+"')("+l+")");var h=v(l,u);!o.raw&&t.autoEscape&&(h="c.l('F','e')("+h+")"),i+="tR+="+h+";"}else if("h"===s)if(t.storage.nativeHelpers.get(c))i+=t.storage.nativeHelpers.get(c)(o,t);else{var y=(m?"await ":"")+"c.l('H','"+c+"')("+g(t,f,o.d,d,m);y+=p?","+b(p,t):",[]",i+="tR+="+v(y+=",c)",u)+";"}else"s"===s?i+="tR+="+v((m?"await ":"")+"c.l('H','"+c+"')({params:["+d+"]},[],c)",u)+";":"e"===s&&(i+=l+"\n")}}return i}var A=function(){function e(e){this.cache=e}return e.prototype.define=function(e,t){this.cache[e]=t},e.prototype.get=function(e){return this.cache[e]},e.prototype.remove=function(e){delete this.cache[e]},e.prototype.reset=function(){this.cache={}},e.prototype.load=function(e){s(this.cache,e,!0)},e}();function _(e,n,r,i){if(n&&n.length>0)throw t((i?"Native":"")+"Helper '"+e+"' doesn't accept blocks");if(r&&r.length>0)throw t((i?"Native":"")+"Helper '"+e+"' doesn't accept filters")}var N={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function $(e){return N[e]}var S=new A({}),T=new A({each:function(e,t){var n="",r=e.params[0];if(_("each",t,!1),e.async)return new Promise((function(t){!function e(t,n,r,i,a){r(t[n],n).then((function(o){i+=o,n===t.length-1?a(i):e(t,n+1,r,i,a)}))}(r,0,e.exec,n,t)}));for(var i=0;i<r.length;i++)n+=e.exec(r[i],i);return n},foreach:function(e,t){var n=e.params[0];if(_("foreach",t,!1),e.async)return new Promise((function(t){!function e(t,n,r,i,a,o){i(n[r],t[n[r]]).then((function(s){a+=s,r===n.length-1?o(a):e(t,n,r+1,i,a,o)}))}(n,Object.keys(n),0,e.exec,"",t)}));var r="";for(var i in n)o(n,i)&&(r+=e.exec(i,n[i]));return r},include:function(e,n,r){_("include",n,!1);var i=r.storage.templates.get(e.params[0]);if(!i)throw t('Could not fetch template "'+e.params[0]+'"');return i(e.params[1],r)},extends:function(e,n,r){var i=e.params[1]||{};i.content=e.exec();for(var a=0;a<n.length;a++){var o=n[a];i[o.name]=o.exec()}var s=r.storage.templates.get(e.params[0]);if(!s)throw t('Could not fetch template "'+e.params[0]+'"');return s(i,r)},useScope:function(e,t){return _("useScope",t,!1),e.exec(e.params[0])}}),w=new A({if:function(e,t){_("if",!1,e.f,!0);var n="if("+e.p+"){"+x(e.d,t)+"}";if(e.b)for(var r=0;r<e.b.length;r++){var i=e.b[r];"else"===i.n?n+="else{"+x(i.d,t)+"}":"elif"===i.n&&(n+="else if("+i.p+"){"+x(i.d,t)+"}")}return n},try:function(e,n){if(_("try",!1,e.f,!0),!e.b||1!==e.b.length||"catch"!==e.b[0].n)throw t("native helper 'try' only accepts 1 block, 'catch'");var r="try{"+x(e.d,n)+"}",i=e.b[0];return r+"catch"+(i.res?"("+i.res+")":"")+"{"+x(i.d,n)+"}"},block:function(e,t){return _("block",e.b,e.f,!0),"if(!"+t.varName+"["+e.p+"]){tR+=("+y(e.d,"",t)+")()}else{tR+="+t.varName+"["+e.p+"]}"}}),C=new A({e:function(e){var t=String(e);return/[&<>"']/.test(t)?t.replace(/[&<>"']/g,$):t}}),E={varName:"it",autoTrim:[!1,"nl"],autoEscape:!0,defaultFilter:!1,tags:["{{","}}"],l:function(e,n){if("H"===e){var r=this.storage.helpers.get(n);if(r)return r;throw t("Can't find helper '"+n+"'")}if("F"===e){var i=this.storage.filters.get(n);if(i)return i;throw t("Can't find filter '"+n+"'")}},async:!1,storage:{helpers:T,nativeHelpers:w,filters:C,templates:S},prefixes:{h:"@",b:"#",i:"",r:"*",c:"/",e:"!"},cache:!1,plugins:[],useWith:!1};function O(e,t){var n={};return s(n,E),t&&s(n,t),e&&s(n,e),n.l.bind(n),n}function j(e,n){var r=O(n||{}),a=Function;if(r.async){if(!i)throw t("This environment doesn't support async/await");a=i}try{return new a(r.varName,"c","cb",h(e,r))}catch(n){throw n instanceof SyntaxError?t("Bad template syntax\n\n"+n.message+"\n"+Array(n.message.length+1).join("=")+"\n"+h(e,r)):n}}function F(e,t){var n;return t.cache&&t.name&&t.storage.templates.get(t.name)?t.storage.templates.get(t.name):(n="function"==typeof e?e:j(e,t),t.cache&&t.name&&t.storage.templates.define(t.name,n),n)}E.l.bind(E),e.compile=j,e.compileScope=x,e.compileScopeIntoFunction=y,e.compileToString=h,e.defaultConfig=E,e.filters=C,e.getConfig=O,e.helpers=T,e.nativeHelpers=w,e.parse=m,e.render=function(e,n,i,a){var o=O(i||{});if(!o.async)return F(e,o)(n,o);if(!a){if("function"==typeof r)return new r((function(t,r){try{t(F(e,o)(n,o))}catch(e){r(e)}}));throw t("Please provide a callback function, this env doesn't support Promises")}try{F(e,o)(n,o,a)}catch(e){return a(e)}},e.templates=S,Object.defineProperty(e,"__esModule",{value:!0})}(t)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}return n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(341)})()));
//# sourceMappingURL=index.js.map